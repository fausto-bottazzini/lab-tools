# prueba
from settings import DB_HOST, DB_PORT, configure_logging

configure_logging()
print(f"Conectando a {DB_HOST}:{DB_PORT}")

from settings.derivadas import derivadas_parciales, derivadas_parciales_segundas
from settings.matrices import jacobiano, hessiano, gradiente, laplaciano
from settings.propagacion import propagacion_std, propagacion
from settings.series import serie_fourier, serie_taylor
from settings.funciones import numpy_a_sympy

import sympy as sp
import numpy as np
import matplotlib.pyplot as plt

# Funciones de prueba
def f1(x):
    return sp.sin(x)

def f2(x, a):
    return a * x**2 + sp.cos(x)

def f3(x, a, b):
    return a * sp.exp(-b * x)

# Valores de prueba
val = [1.0, 2.0, 3]
cov = [
    [0.01, 0.002, 0.001],
    [0.002, 0.04, 0.005],
    [0.001, 0.005, 0.09]
]
points = np.linspace(0, 1, 3)

# Testeo general
results = {
    "Derivadas f3": derivadas_parciales(f3, val),
    "Hessiano f3": hessiano(f3, ["a", "b"], val),
    "Jacobiano f3": jacobiano(f3, val = val),
    "Propagación STD": propagacion_std(f3, val ,[0.1, 0.2, 0.03]),
    "Propagación COV": propagacion(f3, val, cov),
    "Gradiente f3": gradiente(f3, val),
    "Laplaciano f2": laplaciano(f2),
    "Taylor eval": serie_taylor(f2, p0=0, n=4, eval=True, param=(2,), points=points),
    "Fourier eval": serie_fourier(f1, intervalo=(-np.pi, np.pi), n=5, sistema='trigonometrico', eval=True)
}

for key, val in results.items():
    print(f"\n--- {key} ---")
    print(val)

exit()
# --- Crear gráfico ---
fig, ax = plt.subplots()
ax.plot(x, y, label='línea 1')
ax.fill_between(x, y - 0.2, y + 0.2, color='blue', alpha=0.3, label='error')
ax.set_title("Prueba de gráfico lineal")
ax.set_xlabel("Eje X")
ax.set_ylabel("Eje Y")
ax.grid(True, linestyle=':', linewidth=0.5, color='white', alpha=0.3)
configurar_estilo_axes(ax)
ax.legend()
plt.show()


